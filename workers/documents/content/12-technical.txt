TECHNICAL ARCHITECTURE
======================

Infrastructure and system design details.

Frontend Architecture
---------------------

FRAMEWORK: Next.js 14 (App Router)
- Server-side rendering for SEO
- Client-side navigation for speed
- App directory structure
- React Server Components where applicable

ROUTING STRUCTURE
/                    - Landing/Login page
/dashboard           - Main dashboard
/dashboard/analytics - Analytics page
/dashboard/blocks    - Block schedule
/dashboard/goals     - Goal tracking
/dashboard/history   - Time entry history
/dashboard/journal   - Journal system
/dashboard/projects  - Project management
/dashboard/reports   - Monthly reports
/dashboard/schedule  - Personal schedule
/dashboard/settings  - User settings
/dashboard/admin/*   - Admin-only pages

STATE MANAGEMENT
- React Context API for global state
- AuthContext: User authentication
- SettingsContext: User preferences
- JournalContext: Journal entries
- GamificationContext: XP and achievements
- Custom hooks for data fetching

STYLING
- Tailwind CSS for utility classes
- Custom design system (tailwind.config.ts)
- CSS variables for theming
- Responsive breakpoints: sm, md, lg, xl

Backend Architecture
--------------------

PLATFORM: Cloudflare Workers
- Edge computing (runs close to users)
- Serverless (no server management)
- Automatic scaling
- Global distribution

DATABASE: Cloudflare D1
- SQLite at the edge
- Low latency reads/writes
- Automatic replication
- SQL-based queries

API DESIGN: RESTful
- JSON request/response
- JWT authentication
- CORS configured
- Error handling standardized

Security
--------

AUTHENTICATION
- Email + PIN login
- PIN hashed with SHA-256
- JWT tokens for sessions
- 7-day token expiration
- HTTP-only cookie storage

AUTHORIZATION
- Role-based access (admin/worker)
- API endpoint protection
- Admin-only route guards
- User data isolation

DATA PROTECTION
- HTTPS everywhere
- No sensitive data in URLs
- Input validation
- SQL injection prevention (parameterized queries)

Database Schema
---------------

USERS TABLE
- id, email, name, pin_hash, role, active
- created_at, updated_at

PROJECTS TABLE
- id, name, description, color, active
- created_at, updated_at

TIME_ENTRIES TABLE
- id, user_id, project_id, clock_in, clock_out
- break_minutes, notes, created_at, updated_at

BREAKS TABLE
- id, time_entry_id, start_time, end_time
- created_at

SESSIONS TABLE
- id, user_id, token_hash, expires_at
- created_at

JOURNAL_ENTRIES TABLE
- id, user_id, title, content, rich_content
- source, source_id, tags, created_at, updated_at

Performance
-----------
- Edge caching for static assets
- Lazy loading for charts
- Optimistic UI updates
- Debounced auto-save
- Efficient database queries
